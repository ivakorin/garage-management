# README: Правила формирования топиков MQTT для внешних устройств

## 1. Базовая структура топика

Топики должны соответствовать маске:

```text
devices/device_id/sensor_type
```

****Обязательные компоненты:****

- devices— корневой префикс (фиксированный);
- device_id— уникальный идентификатор устройства;
- sensor_type— тип сенсора/данных.

****Пример корректного топика:****

```text
devices/sensor-001/temperature
```

## 2. Требования к компонентам топика

### 2.1. device_id

- ****Формат:**** строка без пробелов и спецсимволов (допускается-,\_);
- ****Длина:**** 1–32 символа;
- ****Регистр:**** чувствителен к регистру;
- ****Уникальность:**** должен быть уникальным в пределах системы.

****Примеры допустимых значений:****

- sensor-001
- gateway_A
- lamp-1

### 2.2. sensor_type

- ****Формат:**** строка без пробелов (можно использовать-,\_);
- ****Рекомендуемый список типов****(не ограничивающий):
    - temperature
    - humidity
    - pressure
    - light
    - motion
    - online(специальный тип для статуса)

****Примеры:****

- temperature
- co2-level
- door-status

## 3. Специальные топики

### 3.1. Статус онлайн/офлайн

- ****Топик:**** devices/device_id/online
- ****Payload:**** строка"true"или"false"(в кавычках!).

****Пример:****

- Топик: devices/sensor-001/online
- Payload:"true"

### 3.2. Данные сенсоров

- ****Топик:**** devices/device_id/sensor_type
- ****Payload:**** JSON с полями value и unit.

****Пример JSON:****

```json
{
  "value": 23.5,
  "unit": "°C"
}
```

## 4. Примеры корректных топиков и payload

### Пример 1: Температура

- ****Топик:**** devices/sensor-001/temperature
- ****Payload:****

```json
{
  "value": 23.5,
  "unit": "°C"
}
```

### Пример 2: Влажность

- ****Топик:**** devices/sensor-001/humidity
- ****Payload:****

```json
{
  "value": 45,
  "unit": "%"
}
```

### Пример 3: Статус устройства

- ****Топик:**** devices/sensor-001/online
- ****Payload:**** "true"

## **5. Запрещённые практики**

- ****Не используйте пробелы****в топиках (например, devices/sensor 1/temp — **ошибка**);
- ****Не пропускайте уровни****(например, sensor-001/temperature—****ошибка****, нет
  префикса devices);
- ****Не отправляйте _НЕ_ JSON**** в топики данных (кроме/online);
- ****Не меняйте регистр**** device_id между сообщениями (система считает их разными
  устройствами).

## **6. Рекомендации**

1. ****Используйте понятные идентификаторы:****
    - devices/living-room-sensor/temperature лучше, чем devices/d1/t.
2. ****Соблюдайте единообразие:****
    - Если начали использовать "-", не переключайтесь на "_" в рамках одного устройства.
3. ****Тестируйте топики**** перед массовым развёртыванием.
4. ****Следите за длиной:****
    - Слишком длинные топики (более 100 символов) могут вызывать проблемы у MQTT‑брокеров.
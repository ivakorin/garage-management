### **Порядок установки приложения _Garage Management_**

Установка выполняется через скрипт install.sh, который автоматизирует развёртывание
базовой инфраструктуры. Ниже — пошаговая инструкция с пояснениями.

### **Предварительные требования**

Перед запуском скрипта убедитесь, что на машине установлены:

- git — для клонирования репозитория;
- docker и docker-compose — для запуска сервисов;
- права на запись в целевую директорию.

### **Пошаговая инструкция**

1. ****Скачайте скрипт**** install.sh  
   Получите файл из репозитория (например, через wget или вручную):

```bash
wget https://gitflic.ru/project/ivakorin/garage-management.git/install.sh
```

1. ****Запустите скрипт****  
   Выполните скрипт в терминале:

```bash
bash install.sh
```

1. ****Укажите путь для установки****  
   Скрипт запросит путь:

```text
Введите путь для установки (пусто = текущая директория):
```

- Оставьте пустым — установка пройдёт в текущую директорию.
- Укажите путь (например, /opt/garage) — скрипт создаст директорию, если её нет.]()

1. ****Клонирование репозитория****  
   Скрипт автоматически:
    - клонирует репозиторий в временную папку tmp_garage_management;
    - проверяет успешность операции.
2. ****Копирование конфигурационных файлов****  
   Из репозитория копируются:
    - файлы из services/docker/ (кроме файлов с Dockerfile в имени);
    - пример окружения .env_example → переименовывается в .env;
    - плагины из backend/plugins/ → копируются в директорию plugins/.
3. ****Очистка временных файлов****
    - удаляются все файлы .gitkeep (они нужны только для Git);
    - временная папка tmp_garage_management удаляется.
4. ****Настройка прав доступа****  
   Файл mosquitto/init-mqtt.sh делается исполняемым (если присутствует).
5. ****Завершение установки****  
   В терминале появится сообщение:

```text
Установка завершена!

→ Файлы скопированы в: /путь/к/установке

→ Проверьте файл .env и настройте его при необходимости.

→ Для запуска используйте: docker-compose up -d
```

### **Что дальше?**

1. ****Настройте файл**** .env  
   Откройте файл .env в текстовом редакторе и укажите:
    - параметры БД (хост, порт, логин, пароль);
    - настройки MQTT‑сервера;
    - ключи API и другие переменные окружения.
2. ****Запустите сервисы через Docker Compose****  
   В директории установки выполните:

```text
docker-compose up -d
```

Это запустит:

- бэкенд (FastAPI);
    - фронтенд (Vue.js);
    - MQTT‑сервер (Mosquitto);
    - Redis;
    - Nginx (прокси).

1. ****Проверьте работу****

- Откройте в браузере http://<ваш-сервер>:80 — должен загрузиться фронтенд.
- Убедитесь, что API доступно по http://<ваш-сервер>/api/v1/.

2. ****Добавьте плагины (опционально)****  
   Поместите кастомные плагины в директорию plugins/ (структура должна соответствовать
   примерам из репозитория).

### **Возможные проблемы и решения**

- ****Ошибка клонирования репозитория****  
  Проверьте интернет‑соединение и доступность
  URL https://gitflic.ru/project/ivakorin/garage-management.git.
- ****Нет прав на запись****  
  Запустите скрипт от имени администратора (sudo bash install.sh) или выберите директорию
  с правами на запись.
- ****Ошибка в**** .env  
  Убедитесь, что все переменные указаны корректно (особенно пароли и хосты).
- ****Docker‑сервисы не стартуют****  
  Проверьте:
- установлен ли Docker и Docker Compose;
- нет ли конфликта портов (например, если Nginx уже запущен);
- логи через docker-compose logs <сервис>.

### **Структура после установки**

После выполнения скрипта в целевой директории будут:

- docker-compose.yaml — конфигурация Docker;
- .env — переменные окружения;
- redis/ - данные Redis;
- plugins/ — директория для плагинов;
- mosquitto/ — конфигурация MQTT;
- nginx/ — конфигурация Nginx;
- base/ - файл базы данных;
- другие файлы из services/docker/.